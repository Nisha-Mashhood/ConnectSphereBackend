{"version":3,"file":"group-repository.js","sourceRoot":"","sources":["../../src/Repositories/group-repository.ts"],"names":[],"mappings":"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","sourcesContent":["import { injectable } from 'inversify';\r\nimport { Model, Types } from 'mongoose';\r\nimport { BaseRepository } from '../core/repositries/base-repositry';\r\nimport { RepositoryError } from '../core/utils/error-handler';\r\nimport logger from '../core/utils/logger';\r\nimport Group from '../Models/group-model';\r\nimport GroupRequest from '../Models/group-request-model';\r\nimport { IGroup } from '../Interfaces/Models/i-group';\r\nimport { IGroupRequest } from '../Interfaces/Models/i-group-request';\r\nimport { GroupFormData, GroupQuery } from '../Utils/types/group-types';\r\nimport { StatusCodes } from '../enums/status-code-enums';\r\nimport { IGroupRepository } from '../Interfaces/Repository/i-group-repositry';\r\n\r\n@injectable()\r\nexport class GroupRepository extends BaseRepository<IGroup> implements IGroupRepository{\r\n  private _groupRequestModel: Model<IGroupRequest>;\r\n\r\n  constructor() {\r\n    super(Group as Model<IGroup>);\r\n    this._groupRequestModel = GroupRequest;\r\n  }\r\n\r\n  private toObjectId = (id?: string | Types.ObjectId): Types.ObjectId => {\r\n    if (!id) {\r\n      logger.warn('Missing ID when converting to ObjectId');\r\n      throw new RepositoryError('Invalid ID: ID is required', StatusCodes.BAD_REQUEST);\r\n    }\r\n    const idStr = typeof id === 'string' ? id : id.toString();\r\n    if (!Types.ObjectId.isValid(idStr)) {\r\n      logger.warn(`Invalid ObjectId format: ${idStr}`);\r\n      throw new RepositoryError('Invalid ID: must be a 24 character hex string', StatusCodes.BAD_REQUEST);\r\n    }\r\n    return new Types.ObjectId(idStr);\r\n  }\r\n\r\n   public createGroup = async (groupData: GroupFormData): Promise<IGroup> => {\r\n    try {\r\n      logger.debug(`Creating group with name: ${groupData.name}`);\r\n      const newGroup = await this.create({\r\n        ...groupData,\r\n        adminId: this.toObjectId(groupData.adminId),\r\n        createdAt: groupData.createdAt || new Date(),\r\n        isFull: false,\r\n        startDate: groupData.startDate ? new Date(groupData.startDate) : undefined,\r\n        members: groupData.members\r\n          ? groupData.members.map((userId: string) => ({\r\n              userId: this.toObjectId(userId),\r\n              joinedAt: new Date(),\r\n            }))\r\n          : [],\r\n      });\r\n      logger.info(`Created group: ${newGroup._id}`);\r\n      return newGroup;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error creating group with name ${groupData.name}`, err);\r\n      throw new RepositoryError('Error creating group', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public getGroupsByAdminId = async (adminId: string): Promise<IGroup[]> => {\r\n    try {\r\n      logger.debug(`Fetching groups for admin: ${adminId}`);\r\n      const groups = await this.model\r\n        .find({ adminId: this.toObjectId(adminId) })\r\n        .populate('members.userId', '_id name email jobTitle profilePic')\r\n        .populate('adminId', '_id name email jobTitle profilePic')\r\n        .exec();\r\n      logger.info(`Fetched ${groups.length} groups for adminId: ${adminId}`);\r\n      return groups;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching groups for adminId ${adminId}`, err);\r\n      throw new RepositoryError('Error fetching groups by admin ID', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public getGroupById = async (groupId: string): Promise<IGroup | null> => {\r\n    try {\r\n      logger.debug(`Fetching group by ID: ${groupId}`);\r\n      const group = await this.model\r\n        .findById(this.toObjectId(groupId))\r\n        .populate('members.userId')\r\n        .populate('adminId')\r\n        .exec();\r\n      logger.info(`Group ${group ? 'found' : 'not found'}: ${groupId}`);\r\n      return group;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching group by ID ${groupId}`, err);\r\n      throw new RepositoryError('Error fetching group by ID', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public getAllGroups = async (query: GroupQuery = {}): Promise<{ groups: IGroup[]; total: number }> => {\r\n    try {\r\n      logger.debug(`Fetching all groups with query: ${JSON.stringify(query)}`);\r\n      const { search, page, limit, excludeAdminId } = query;\r\n\r\n      if (!search && !page && !limit) {\r\n        const groups = await this.model\r\n          .find()\r\n          .populate('members.userId', '_id name email jobTitle profilePic')\r\n          .populate('adminId', '_id name email jobTitle profilePic')\r\n          .exec();\r\n        logger.info(`Fetched ${groups.length} groups`);\r\n        return { groups, total: groups.length };\r\n      }\r\n\r\n      const matchStage: Record<string, any> = {};\r\n      if (search) {\r\n        matchStage.name = { $regex: search, $options: 'i' };\r\n      }\r\n      if (excludeAdminId) {\r\n        matchStage.adminId = { $ne: this.toObjectId(excludeAdminId) };\r\n      }\r\n\r\n      const pipeline = [\r\n      { $match: matchStage },\r\n      { $unwind: { path: '$members', preserveNullAndEmptyArrays: true } },\r\n      {\r\n        $lookup: {\r\n          from: 'users',\r\n          localField: 'members.userId',\r\n          foreignField: '_id',\r\n          as: 'members.userId',\r\n        },\r\n      },\r\n      {\r\n        $unwind: {\r\n          path: '$members.userId',\r\n          preserveNullAndEmptyArrays: true,\r\n        },\r\n      },\r\n      {\r\n        $group: {\r\n          _id: '$_id',\r\n          groupId: { $first: '$groupId' },\r\n          name: { $first: '$name' },\r\n          bio: { $first: '$bio' },\r\n          price: { $first: '$price' },\r\n          maxMembers: { $first: '$maxMembers' },\r\n          isFull: { $first: '$isFull' },\r\n          availableSlots: { $first: '$availableSlots' },\r\n          profilePic: { $first: '$profilePic' },\r\n          coverPic: { $first: '$coverPic' },\r\n          startDate: { $first: '$startDate' },\r\n          createdAt: { $first: '$createdAt' },\r\n          updatedAt: { $first: '$updatedAt' },\r\n          adminId: { $first: '$adminId' },\r\n          members: {\r\n            $push: {\r\n              $cond: [\r\n                { $eq: ['$members', {}] },\r\n                null,\r\n                {\r\n                  userId: '$members.userId',\r\n                  joinedAt: '$members.joinedAt',\r\n                  _id: '$members._id',\r\n                },\r\n              ],\r\n            },\r\n          },\r\n        },\r\n      },\r\n      {\r\n        $addFields: {\r\n          members: {\r\n            $filter: {\r\n              input: '$members',\r\n              as: 'member',\r\n              cond: { $ne: ['$$member', null] },\r\n            },\r\n          },\r\n        },\r\n      },\r\n      {\r\n        $lookup: {\r\n          from: 'users',\r\n          localField: 'adminId',\r\n          foreignField: '_id',\r\n          as: 'adminId',\r\n        },\r\n      },\r\n      {\r\n        $unwind: {\r\n          path: '$adminId',\r\n          preserveNullAndEmptyArrays: true,\r\n        },\r\n      },\r\n      {\r\n        $facet: {\r\n          groups: [\r\n            { $skip: ((page || 1) - 1) * (limit || 10) },\r\n            { $limit: limit || 10 },\r\n          ],\r\n          total: [{ $count: 'count' }],\r\n        },\r\n      },\r\n    ];\r\n\r\n      const result = await this.model.aggregate(pipeline).exec();\r\n      const groups = result[0]?.groups || [];\r\n      const total = result[0]?.total[0]?.count || 0;\r\n\r\n      logger.info(`Fetched ${groups.length} groups, total: ${total}`);\r\n      return { groups, total };\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching all groups`, err);\r\n      throw new RepositoryError('Error fetching all groups', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public createGroupRequest = async (data: { groupId: string; userId: string }): Promise<IGroupRequest> => {\r\n    try {\r\n      logger.debug(`Creating group request for group: ${data.groupId}, user: ${data.userId}`);\r\n      const request = await this._groupRequestModel.create({\r\n        groupId: this.toObjectId(data.groupId),\r\n        userId: this.toObjectId(data.userId),\r\n        status: 'Pending',\r\n        paymentStatus: 'Pending',\r\n      });\r\n      logger.info(`Group request created: ${request._id}`);\r\n      return request;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error creating group request for group ${data.groupId}`, err);\r\n      throw new RepositoryError('Error creating group request', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public getGroupRequestsByGroupId = async (groupId: string): Promise<IGroupRequest[]> => {\r\n    try {\r\n      logger.debug(`Fetching group requests for group: ${groupId}`);\r\n      const requests = await this._groupRequestModel\r\n        .find({ groupId: this.toObjectId(groupId) })\r\n        .populate({\r\n          path: 'groupId',\r\n          populate: {\r\n            path: 'members.userId',\r\n            model: 'User',\r\n            select: '_id name email jobTitle profilePic',\r\n          },\r\n        })\r\n        .populate('userId', '_id name email jobTitle profilePic')\r\n        .exec();\r\n      logger.info(`Fetched ${requests.length} group requests for groupId: ${groupId}`);\r\n      return requests;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching group requests for groupId ${groupId}`, err);\r\n      throw new RepositoryError('Error fetching group requests by group ID', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public getGroupRequestsByAdminId = async (adminId: string): Promise<IGroupRequest[]> => {\r\n    try {\r\n      logger.debug(`Fetching group requests for admin: ${adminId}`);\r\n      const requests = await this._groupRequestModel\r\n        .find()\r\n        .populate({\r\n          path: 'groupId',\r\n          match: { adminId: this.toObjectId(adminId) },\r\n          populate: {\r\n            path: 'members.userId',\r\n            model: 'User',\r\n            select: '_id name email jobTitle profilePic',\r\n          },\r\n        })\r\n        .populate('userId', '_id name email jobTitle profilePic')\r\n        .exec()\r\n        .then((requests) => requests.filter((req) => req.groupId));\r\n      logger.info(`Fetched ${requests.length} group requests for adminId: ${adminId}`);\r\n      return requests;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching group requests for adminId ${adminId}`, err);\r\n      throw new RepositoryError('Error fetching group requests by admin ID', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public getGroupRequestsByUserId = async (userId: string): Promise<IGroupRequest[]> => {\r\n    try {\r\n      logger.debug(`Fetching group requests for user: ${userId}`);\r\n      const requests = await this._groupRequestModel\r\n        .find({ userId: this.toObjectId(userId) })\r\n        .populate({\r\n          path: 'groupId',\r\n          populate: {\r\n            path: 'members.userId',\r\n            model: 'User',\r\n            select: '_id name email jobTitle profilePic',\r\n          },\r\n        })\r\n        .populate('userId', '_id name email jobTitle profilePic')\r\n        .exec();\r\n      logger.info(`Fetched ${requests.length} group requests for userId: ${userId}`);\r\n      return requests;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching group requests for userId ${userId}`, err);\r\n      throw new RepositoryError('Error fetching group requests by user ID', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public findGroupRequestById = async (requestId: string): Promise<IGroupRequest | null> => {\r\n    try {\r\n      logger.debug(`Fetching group request by ID: ${requestId}`);\r\n      const request = await this._groupRequestModel\r\n        .findById(this.toObjectId(requestId))\r\n        .populate({\r\n          path: 'groupId',\r\n          populate: [\r\n            {\r\n              path: 'adminId',\r\n              model: 'User',\r\n              select: '_id name email jobTitle profilePic',\r\n            },\r\n            {\r\n              path: 'members.userId',\r\n              model: 'User',\r\n              select: '_id name email jobTitle profilePic',\r\n            },\r\n          ],\r\n        })\r\n        .populate('userId', '_id name email jobTitle profilePic')\r\n        .exec();\r\n      logger.info(`Group request ${request ? 'found' : 'not found'}: ${requestId}`);\r\n      return request;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching group request by ID ${requestId}`, err);\r\n      throw new RepositoryError('Error fetching group request by ID', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public updateGroupRequestStatus = async (\r\n    requestId: string,\r\n    status: 'Accepted' | 'Rejected'\r\n  ): Promise<IGroupRequest | null> => {\r\n    try {\r\n      logger.debug(`Updating group request status for ID: ${requestId} to ${status}`);\r\n      const request = await this._groupRequestModel\r\n        .findByIdAndUpdate(this.toObjectId(requestId), { status }, { new: true })\r\n        .exec();\r\n      if (!request) {\r\n        logger.warn(`Group request not found: ${requestId}`);\r\n        throw new RepositoryError(`Group request not found with ID: ${requestId}`, StatusCodes.NOT_FOUND);\r\n      }\r\n      logger.info(`Group request status updated: ${requestId} to ${status}`);\r\n      return request;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error updating group request status for ID ${requestId}`, err);\r\n      throw new RepositoryError('Error updating group request status', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public updateGroupPaymentStatus = async (\r\n    requestId: string,\r\n    amountPaid: number\r\n  ): Promise<IGroupRequest | null> => {\r\n    try {\r\n      logger.debug(`Updating group payment status for request: ${requestId}`);\r\n      const request = await this._groupRequestModel\r\n        .findByIdAndUpdate(\r\n          this.toObjectId(requestId),\r\n          { paymentStatus: 'Completed', amountPaid },\r\n          { new: true }\r\n        )\r\n        .exec();\r\n      if (!request) {\r\n        logger.warn(`Group request not found: ${requestId}`);\r\n        throw new RepositoryError(`Group request not found with ID: ${requestId}`, StatusCodes.NOT_FOUND);\r\n      }\r\n      logger.info(`Group payment status updated: ${requestId}`);\r\n      return request;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error updating group payment status for request ${requestId}`, err);\r\n      throw new RepositoryError('Error updating group payment status', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public addMemberToGroup = async (groupId: string, userId: string): Promise<IGroup | null> => {\r\n    try {\r\n      logger.debug(`Adding user ${userId} to group ${groupId}`);\r\n      const group = await this.model.findById(this.toObjectId(groupId)).exec();\r\n      if (!group) {\r\n        logger.warn(`Group not found: ${groupId}`);\r\n        throw new RepositoryError(`Group not found with ID: ${groupId}`, StatusCodes.NOT_FOUND);\r\n      }\r\n      const isUserAlreadyInGroup = group.members.some(\r\n        (member) => member.userId.toString() === userId\r\n      );\r\n      if (!isUserAlreadyInGroup) {\r\n        group.members.push({ userId: this.toObjectId(userId), joinedAt: new Date() });\r\n        group.isFull = group.members.length >= group.maxMembers;\r\n        const updatedGroup = await group.save();\r\n        logger.info(`User ${userId} added to group ${groupId}`);\r\n        return updatedGroup;\r\n      }\r\n      logger.info(`User ${userId} already in group ${groupId}`);\r\n      return group;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error adding user ${userId} to group ${groupId}`, err);\r\n      throw new RepositoryError('Error adding member to group', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public deleteGroupRequest = async (requestId: string): Promise<void> => {\r\n    try {\r\n      logger.debug(`Deleting group request: ${requestId}`);\r\n      const result = await this._groupRequestModel.findByIdAndDelete(this.toObjectId(requestId)).exec();\r\n      if (!result) {\r\n        logger.warn(`Group request not found: ${requestId}`);\r\n        throw new RepositoryError(`Group request not found with ID: ${requestId}`, StatusCodes.NOT_FOUND);\r\n      }\r\n      logger.info(`Group request deleted: ${requestId}`);\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error deleting group request ${requestId}`, err);\r\n      throw new RepositoryError('Error deleting group request', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public removeGroupMember = async (groupId: string, userId: string): Promise<IGroup | null> => {\r\n    try {\r\n      logger.debug(`Removing user ${userId} from group ${groupId}`);\r\n      const group = await this.model.findById(this.toObjectId(groupId)).exec();\r\n      if (!group) {\r\n        logger.warn(`Group not found: ${groupId}`);\r\n        throw new RepositoryError(`Group not found with ID: ${groupId}`, StatusCodes.NOT_FOUND);\r\n      }\r\n      if (userId === group.adminId.toString()) {\r\n        logger.warn(`Attempted to remove admin ${userId} from group ${groupId}`);\r\n        throw new RepositoryError('Cannot remove admin from group members', StatusCodes.BAD_REQUEST);\r\n      }\r\n      group.members = group.members.filter(\r\n        (member) => member.userId.toString() !== userId\r\n      );\r\n      group.isFull = group.members.length >= group.maxMembers;\r\n      const updatedGroup = await group.save();\r\n      logger.info(`User ${userId} removed from group ${groupId}`);\r\n      return updatedGroup;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error removing user ${userId} from group ${groupId}`, err);\r\n      throw new RepositoryError('Error removing group member', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public deleteGroupById = async (groupId: string): Promise<IGroup | null> => {\r\n    try {\r\n      logger.debug(`Deleting group: ${groupId}`);\r\n      const group = await this.findByIdAndDelete(groupId);\r\n      if (!group) {\r\n        logger.warn(`Group not found: ${groupId}`);\r\n        throw new RepositoryError(`Group not found with ID: ${groupId}`, StatusCodes.NOT_FOUND);\r\n      }\r\n      logger.info(`Group deleted: ${groupId}`);\r\n      return group;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error deleting group ${groupId}`, err);\r\n      throw new RepositoryError('Error deleting group', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n  public deleteGroupRequestsByGroupId = async (groupId: string): Promise<void> => {\r\n    try {\r\n      logger.debug(`Deleting group requests for group: ${groupId}`);\r\n      const result = await this._groupRequestModel.deleteMany({ groupId: this.toObjectId(groupId) }).exec();\r\n      logger.info(`Deleted ${result.deletedCount || 0} group requests for groupId: ${groupId}`);\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error deleting group requests for groupId ${groupId}`, err);\r\n      throw new RepositoryError('Error deleting group requests', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n  public updateGroupImage = async (\r\n    groupId: string,\r\n    updateData: { profilePic?: string; coverPic?: string }\r\n  ): Promise<IGroup | null> => {\r\n    try {\r\n      logger.debug(`Updating group image for group: ${groupId}`);\r\n      const group = await this.findByIdAndUpdate(groupId, updateData, { new: true });\r\n      if (!group) {\r\n        logger.warn(`Group not found: ${groupId}`);\r\n        throw new RepositoryError(`Group not found with ID: ${groupId}`, StatusCodes.NOT_FOUND);\r\n      }\r\n      logger.info(`Group image updated for group: ${groupId}`);\r\n      return group;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error updating group image for group ${groupId}`, err);\r\n      throw new RepositoryError('Error updating group image', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n  public getGroupDetailsByUserId = async (userId: string): Promise<IGroup[]> => {\r\n    try {\r\n      logger.debug(`Fetching group details for user: ${userId}`);\r\n      const groups = await this.model\r\n        .find({ 'members.userId': this.toObjectId(userId) })\r\n        .populate('members.userId', '_id name email jobTitle profilePic')\r\n        .populate('adminId', '_id name email jobTitle profilePic')\r\n        .exec();\r\n      logger.info(`Fetched ${groups.length} groups for userId: ${userId}`);\r\n      return groups;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching group details for userId ${userId}`, err);\r\n      throw new RepositoryError('Error fetching group details by user ID', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n\r\n  public getAllGroupRequests = async (\r\n  search: string = \"\",\r\n  page: number = 1,\r\n  limit: number = 10\r\n): Promise<IGroupRequest[]> => {\r\n  try {\r\n    const allRequests = await this._groupRequestModel\r\n      .find()\r\n      .populate({\r\n        path: \"groupId\",\r\n        model: \"Group\",\r\n        populate: {\r\n          path: \"members.userId\",\r\n          model: \"User\",\r\n          select: \"_id name email jobTitle profilePic\",\r\n        },\r\n      })\r\n      .populate({\r\n        path: \"userId\",\r\n        model: \"User\",\r\n        select: \"_id name email jobTitle profilePic\",\r\n      })\r\n      .sort({ createdAt: -1 })\r\n      .exec();\r\n\r\n    let filteredRequests = allRequests;\r\n\r\n    if (search.trim()) {\r\n      const regex = new RegExp(search, \"i\");\r\n\r\n      filteredRequests = allRequests.filter((req) => {\r\n        const groupName = (req as any).groupId?.name || \"\";\r\n        const userName = (req as any).userId?.name || \"\";\r\n        const userEmail = (req as any).userId?.email || \"\";\r\n\r\n        return (\r\n          regex.test(groupName) ||\r\n          regex.test(userName) ||\r\n          regex.test(userEmail)\r\n        );\r\n      });\r\n    }\r\n\r\n    const total = filteredRequests.length;\r\n    const paginated = filteredRequests.slice((page - 1) * limit, page * limit);\r\n\r\n    logger.info(`Fetched ${paginated.length} group requests (total=${total})`);\r\n    return Object.assign(paginated, { total });\r\n  } catch (error: unknown) {\r\n    const err = error instanceof Error ? error : new Error(String(error));\r\n    logger.error(\"Error fetching group requests\", err);\r\n    throw new RepositoryError(\r\n      \"Error fetching group requests\",\r\n      StatusCodes.INTERNAL_SERVER_ERROR,\r\n      err\r\n    );\r\n  }\r\n};\r\n\r\n\r\n  public isUserInGroup = async (groupId: string, userId: string): Promise<boolean> => {\r\n    try {\r\n      logger.debug(`Checking if user ${userId} is in group ${groupId}`);\r\n      const group = await this.model\r\n        .findOne({ _id: this.toObjectId(groupId), 'members.userId': this.toObjectId(userId) })\r\n        .exec();\r\n      const isInGroup = !!group;\r\n      logger.info(`User ${userId} is ${isInGroup ? '' : 'not '}in group ${groupId}`);\r\n      return isInGroup;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error checking group membership for user ${userId} in group ${groupId}`, err);\r\n      throw new RepositoryError('Error checking group membership', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n  public getGroupMembers = async (groupId: string): Promise<Types.ObjectId[]> => {\r\n      try {\r\n        logger.debug(`Fetching group members for group: ${groupId}`);\r\n        const group = await this.model.findById(this.toObjectId(groupId))\r\n          .select(\"members\")\r\n          .exec();\r\n        if (!group) {\r\n          logger.warn(`Group not found: ${groupId}`);\r\n          throw new RepositoryError(`Group not found with ID: ${groupId}`, StatusCodes.NOT_FOUND);\r\n        }\r\n        const members = group.members.map((member) => {\r\n        const userId =\r\n          typeof member.userId === \"string\"\r\n            ? member.userId\r\n            : member.userId instanceof Types.ObjectId\r\n            ? member.userId\r\n            : member.userId._id; // if it's IUser, take its _id\r\n\r\n          return this.toObjectId(userId);\r\n        });\r\n        logger.info(`Fetched ${members.length} members for group: ${groupId}`);\r\n        return members;\r\n      } catch (error: unknown) {\r\n        const err = error instanceof Error ? error : new Error(String(error));\r\n        logger.error(`Error fetching group members for group ${groupId}`, err);\r\n        throw new RepositoryError('Error fetching group members', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n      }\r\n    }\r\n}"]}