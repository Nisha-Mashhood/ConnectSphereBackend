{"version":3,"file":"skills-repository.js","sourceRoot":"","sources":["../../src/Repositories/skills-repository.ts"],"names":[],"mappings":"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","sourcesContent":["import { injectable } from \"inversify\";\r\nimport { ISkillsRepository } from \"../Interfaces/Repository/i-skills-repositry\";\r\nimport { BaseRepository } from \"../core/repositries/base-repositry\";\r\nimport { RepositoryError } from \"../core/utils/error-handler\";\r\nimport logger from \"../core/utils/logger\";\r\nimport { ISkill, } from \"../Interfaces/Models/i-skill\";\r\nimport { Skill } from \"../Models/skills-model\";\r\nimport { StatusCodes } from \"../enums/status-code-enums\";\r\nimport { Model, Types } from \"mongoose\";\r\n\r\n@injectable()\r\nexport class SkillsRepository extends BaseRepository<ISkill> implements ISkillsRepository{\r\n  constructor() {\r\n    super(Skill as Model<ISkill>);\r\n  }\r\n\r\n   public createSkill = async(data: Partial<ISkill>): Promise<ISkill> =>{\r\n    try {\r\n      logger.debug(`Creating skill: ${data.name} for subcategory ${data.subcategoryId}`);\r\n      const skill = await this.create(data);\r\n      logger.info(`Skill created: ${skill._id} (${skill.name})`);\r\n      return skill;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error creating skill ${data.name}`, err);\r\n      throw new RepositoryError('Error creating skill', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public getAllSkills = async (\r\n    subcategoryId: string,\r\n    query: { search?: string; page?: number; limit?: number } = {}\r\n  ): Promise<{ skills: ISkill[]; total: number }> => {\r\n    try {\r\n      logger.debug(\r\n        `Fetching skills for subcategory: ${subcategoryId} with query: ${JSON.stringify(query)}`\r\n      );\r\n\r\n      const { search, page = 1, limit = 10 } = query;\r\n\r\n      const matchStage: Record<string, any> = {\r\n        subcategoryId: new Types.ObjectId(subcategoryId),\r\n      };\r\n\r\n      if (search) {\r\n        matchStage.name = { $regex: `${search}`, $options: \"i\" };\r\n      }\r\n\r\n      const pipeline= [\r\n        { $match: matchStage },\r\n        {\r\n          $project: {\r\n            _id: 1,\r\n            skillId: 1,\r\n            name: 1,\r\n            description: 1,\r\n            imageUrl: 1,\r\n            categoryId: 1,\r\n            subcategoryId: 1,\r\n            createdAt: 1,\r\n            updatedAt: 1,\r\n          },\r\n        },\r\n        {\r\n          $facet: {\r\n            skills: [\r\n              { $skip: (page - 1) * limit },\r\n              { $limit: limit },\r\n            ],\r\n            total: [{ $count: \"count\" }],\r\n          },\r\n        },\r\n      ];\r\n\r\n      const result = await this.model.aggregate(pipeline).exec();\r\n\r\n      const skills: ISkill[] = result[0]?.skills || [];\r\n      const total: number = result[0]?.total[0]?.count || 0;\r\n\r\n      logger.info(`Fetched ${skills.length} skills (total: ${total})`);\r\n      return { skills, total };\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching skills`, err);\r\n      throw new RepositoryError(\r\n        \"Failed to fetch skills\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n   public getSkillById = async(id: string): Promise<ISkill | null> =>{\r\n    try {\r\n      logger.debug(`Fetching skill by ID: ${id}`);\r\n      const skill = await this.model\r\n        .findById(id)\r\n        .populate(\"categoryId\")\r\n        .populate(\"subcategoryId\")\r\n        .exec();\r\n      if (!skill) {\r\n        logger.warn(`Skill not found: ${id}`);\r\n        throw new RepositoryError(`Skill not found with ID: ${id}`, StatusCodes.NOT_FOUND);\r\n      } else {\r\n        logger.info(`Skill fetched: ${id} (${skill.name})`);\r\n      }\r\n      return skill;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching skill by ID ${id}`, err);\r\n      throw new RepositoryError('Error fetching skill by ID', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public updateSkill = async(id: string, data: Partial<ISkill>): Promise<ISkill | null> =>{\r\n    try {\r\n      logger.debug(`Updating skill: ${id}`);\r\n      const skill = await this.findByIdAndUpdate(id, data, { new: true });\r\n      if (!skill) {\r\n        logger.warn(`Skill not found: ${id}`);\r\n        throw new RepositoryError(`Skill not found with ID: ${id}`, StatusCodes.NOT_FOUND);\r\n      } else {\r\n        logger.info(`Skill updated: ${id} (${skill.name})`);\r\n      }\r\n      return skill;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error updating skill ${id}`, err);\r\n      throw new RepositoryError('Error updating skill', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public deleteSkill = async(id: string): Promise<ISkill | null>=> {\r\n    try {\r\n      logger.debug(`Deleting skill: ${id}`);\r\n      const skill = await this.findByIdAndDelete(id);\r\n      if (!skill) {\r\n        logger.warn(`Skill not found: ${id}`);\r\n        throw new RepositoryError(`Skill not found with ID: ${id}`, StatusCodes.NOT_FOUND);\r\n      } else {\r\n        logger.info(`Skill deleted: ${id} (${skill.name})`);\r\n      }\r\n      return skill;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error deleting skill ${id}`, err);\r\n      throw new RepositoryError('Error deleting skill', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public deleteManySkills = async(\r\n    categoryId: string\r\n  ): Promise<{ deletedCount: number }> =>{\r\n    try {\r\n      logger.debug(`Deleting skills for category: ${categoryId}`);\r\n      const result = await this.model.deleteMany({ categoryId }).exec();\r\n      logger.info(`Deleted ${result.deletedCount} skills for category ${categoryId}`);\r\n      return result;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error deleting skills for category ${categoryId}`, err);\r\n      throw new RepositoryError('Error deleting skills', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public deleteManySkillsBySubcategoryId = async(\r\n    subcategoryId: string\r\n  ): Promise<{ deletedCount: number }> =>{\r\n    try {\r\n      logger.debug(`Deleting skills for subcategory: ${subcategoryId}`);\r\n      const result = await this.model.deleteMany({ subcategoryId }).exec();\r\n      logger.info(`Deleted ${result.deletedCount} skills for subcategory ${subcategoryId}`);\r\n      return result;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error deleting skills for subcategory ${subcategoryId}`, err);\r\n      throw new RepositoryError('Error deleting skills', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n   public getSkills = async(): Promise<{ _id: string; name: string }[]> =>{\r\n    try {\r\n      logger.debug(\"Fetching all skills (name and ID only)\");\r\n      const skills = await this.model\r\n        .find({}, { name: 1, _id: 1 })\r\n        .lean()\r\n        .exec();\r\n      const result = skills.map((skill) => ({\r\n        _id: skill._id.toString(),\r\n        name: skill.name,\r\n      }));\r\n      logger.info(`Fetched ${result.length} skills`);\r\n      return result;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error fetching skills`, err);\r\n      throw new RepositoryError('Error fetching skills', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n\r\n  public isDuplicateSkill = async (name: string, subcategoryId: string, excludeId?: string): Promise<boolean> => {\r\n    try {\r\n      logger.debug(`Checking duplicate skill: ${name} for subcategory: ${subcategoryId}${excludeId ? `, excluding ID: ${excludeId}` : ''}`);\r\n      const query: any = { name, subcategoryId };\r\n      if (excludeId) {\r\n        query._id = { $ne: excludeId };\r\n      }\r\n      const existingSkill = await this.model.findOne(query).exec();\r\n      const isDuplicate = !!existingSkill;\r\n      logger.info(`Duplicate check for skill ${name} in subcategory ${subcategoryId} - ${isDuplicate}`);\r\n      return isDuplicate;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(`Error checking duplicate skill ${name} for subcategory ${subcategoryId}`, err);\r\n      throw new RepositoryError('Error checking duplicate skill', StatusCodes.INTERNAL_SERVER_ERROR, err);\r\n    }\r\n  }\r\n}\r\n"]}