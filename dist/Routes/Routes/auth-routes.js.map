{"version":3,"file":"auth-routes.js","sourceRoot":"","sources":["../../../src/Routes/Routes/auth-routes.ts"],"names":[],"mappings":"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","sourcesContent":["import express from 'express';\r\nimport { AUTH_ROUTES } from '../Constants/auth-routes';\r\nimport container from \"../../container\";\r\nimport { IAuthMiddleware } from '../../Interfaces/Middleware/i-auth-middleware';\r\nimport { apiLimiter, authLimiter } from '../../middlewares/ratelimit-middleware';\r\nimport { upload } from '../../core/utils/multer';\r\nimport { IAuthController } from '../../Interfaces/Controller/i-auth-controller';\r\n\r\nconst router = express.Router();\r\nconst authController = container.get<IAuthController>('IAuthController');\r\nconst authMiddleware = container.get<IAuthMiddleware>('IAuthMiddleware');\r\n\r\n// Public routes\r\nrouter.post(AUTH_ROUTES.Register, authLimiter, authController.signup.bind(authController));\r\nrouter.post(AUTH_ROUTES.Login, authLimiter, authController.login.bind(authController));\r\nrouter.post(AUTH_ROUTES.ForgotPassword, authLimiter, authController.handleForgotPassword.bind(authController));\r\nrouter.post(AUTH_ROUTES.VerifyOTP, authLimiter, authController.handleVerifyOTP.bind(authController));\r\nrouter.post(AUTH_ROUTES.ResentOTP, authLimiter, authController.resendOtp.bind(authController));\r\nrouter.post(AUTH_ROUTES.ResetPassword, authLimiter, authController.handleResetPassword.bind(authController));\r\nrouter.post(AUTH_ROUTES.GoogleSignup, authLimiter, authController.googleSignup.bind(authController));\r\nrouter.post(AUTH_ROUTES.GoogleLogin, authLimiter, authController.googleLogin.bind(authController));\r\nrouter.post(AUTH_ROUTES.GithubSignup, authLimiter, authController.githubSignup.bind(authController));\r\nrouter.post(AUTH_ROUTES.GithubLogin, authLimiter, authController.githubLogin.bind(authController));\r\n\r\n// Protected routes\r\nrouter.post(AUTH_ROUTES.VerifyAdminPasskey, [authLimiter, authMiddleware.verifyToken, authMiddleware.authorize('admin')], authController.verifyPasskey.bind(authController));\r\nrouter.post(AUTH_ROUTES.RefreshToken, [apiLimiter, authMiddleware.verifyRefreshToken], authController.refreshToken.bind(authController));\r\nrouter.post(AUTH_ROUTES.Logout, [apiLimiter], authController.logout.bind(authController));\r\n\r\n// Protected user routes\r\nrouter.get(AUTH_ROUTES.CheckProfile, [apiLimiter, authMiddleware.verifyToken, authMiddleware.checkBlockedStatus], authController.checkProfile.bind(authController));\r\nrouter.get(AUTH_ROUTES.ProfileDetails, [apiLimiter, authMiddleware.verifyToken, authMiddleware.checkBlockedStatus], authController.getProfileDetails.bind(authController));\r\nrouter.put(\r\n  AUTH_ROUTES.UpdateUserDetails,\r\n  [apiLimiter, authMiddleware.verifyToken, authMiddleware.checkBlockedStatus, upload.fields([{ name: 'profilePic', maxCount: 1 }, { name: 'coverPic', maxCount: 1 }])],\r\n  authController.updateUserDetails.bind(authController)\r\n);\r\nrouter.get(AUTH_ROUTES.GetAllUsers, [apiLimiter, authMiddleware.verifyToken], authController.getAllUsers.bind(authController));\r\nrouter.get(AUTH_ROUTES.FetchAllUsers, [apiLimiter, authMiddleware.verifyToken, authMiddleware.authorize('admin')], authController.fetchAllUsers.bind(authController))\r\nrouter.get(AUTH_ROUTES.GetUser, [apiLimiter, authMiddleware.verifyToken], authController.getUserById.bind(authController));\r\nrouter.put(\r\n  AUTH_ROUTES.UpdateUser,\r\n  [apiLimiter, authMiddleware.verifyToken, authMiddleware.checkBlockedStatus, upload.fields([{ name: 'profilePic', maxCount: 1 }, { name: 'coverPic', maxCount: 1 }])],\r\n  authController.updateUserDetails.bind(authController)\r\n);\r\nrouter.put(AUTH_ROUTES.UpdatePassword, [apiLimiter, authMiddleware.verifyToken, authMiddleware.checkBlockedStatus], authController.updatePassword.bind(authController))\r\nrouter.put(AUTH_ROUTES.BlockUser, [apiLimiter, authMiddleware.verifyToken, authMiddleware.authorize('admin')], authController.blockUser.bind(authController));\r\nrouter.put(AUTH_ROUTES.UnblockUser, [apiLimiter, authMiddleware.verifyToken, authMiddleware.authorize('admin')], authController.unblockUser.bind(authController));\r\nrouter.put(AUTH_ROUTES.ChangeRole, [apiLimiter, authMiddleware.verifyToken, authMiddleware.authorize('admin')], authController.changeRole.bind(authController));\r\n\r\nexport default router;"]}