{"version":3,"file":"group-request-mapper.js","sourceRoot":"","sources":["../../../src/Utils/mappers/group-request-mapper.ts"],"names":[],"mappings":";;;;;AAWA,8CA2DC;AAED,gDAIC;AA1ED,iDAA4C;AAC5C,+CAA0C;AAG1C,qEAA6C;AAC7C,uCAAiC;AAIjC,SAAgB,iBAAiB,CAAC,OAA6B;IAC7D,IAAI,CAAC,OAAO,EAAE,CAAC;QACb,gBAAM,CAAC,IAAI,CAAC,4CAA4C,CAAC,CAAC;QAC1D,OAAO,IAAI,CAAC;IACd,CAAC;IAED,kDAAkD;IAClD,IAAI,OAAe,CAAC;IACpB,IAAI,KAA4B,CAAC;IAEjC,IAAI,OAAO,CAAC,OAAO,EAAE,CAAC;QACpB,IAAI,OAAO,OAAO,CAAC,OAAO,KAAK,QAAQ,EAAE,CAAC;YACxC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;QAC5B,CAAC;aAAM,IAAI,OAAO,CAAC,OAAO,YAAY,gBAAK,CAAC,QAAQ,EAAE,CAAC;YACrD,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;QACvC,CAAC;aAAM,CAAC;YACN,2CAA2C;YAC3C,OAAO,GAAI,OAAO,CAAC,OAAkB,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;YACrD,MAAM,QAAQ,GAAG,IAAA,yBAAU,EAAC,OAAO,CAAC,OAAiB,CAAC,CAAC;YACvD,KAAK,GAAG,QAAQ,IAAI,SAAS,CAAC,CAAC,4BAA4B;QAC7D,CAAC;IACH,CAAC;SAAM,CAAC;QACN,gBAAM,CAAC,IAAI,CAAC,iBAAiB,OAAO,CAAC,GAAG,iBAAiB,CAAC,CAAC;QAC3D,OAAO,GAAG,EAAE,CAAC;IACf,CAAC;IAED,gDAAgD;IAChD,IAAI,MAAc,CAAC;IACnB,IAAI,IAA0B,CAAC;IAE/B,IAAI,OAAO,CAAC,MAAM,EAAE,CAAC;QACnB,IAAI,OAAO,OAAO,CAAC,MAAM,KAAK,QAAQ,EAAE,CAAC;YACvC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;QAC1B,CAAC;aAAM,IAAI,OAAO,CAAC,MAAM,YAAY,gBAAK,CAAC,QAAQ,EAAE,CAAC;YACpD,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;QACrC,CAAC;aAAM,CAAC;YACN,0CAA0C;YAC1C,MAAM,GAAI,OAAO,CAAC,MAAgB,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;YAClD,MAAM,OAAO,GAAG,IAAA,uBAAS,EAAC,OAAO,CAAC,MAAe,CAAC,CAAC;YACnD,IAAI,GAAG,OAAO,IAAI,SAAS,CAAC;QAC9B,CAAC;IACH,CAAC;SAAM,CAAC;QACN,gBAAM,CAAC,IAAI,CAAC,iBAAiB,OAAO,CAAC,GAAG,gBAAgB,CAAC,CAAC;QAC1D,MAAM,GAAG,EAAE,CAAC;IACd,CAAC;IAED,OAAO;QACL,EAAE,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE;QAC1B,cAAc,EAAE,OAAO,CAAC,cAAc;QACtC,OAAO;QACP,KAAK;QACL,MAAM;QACN,IAAI;QACJ,MAAM,EAAE,OAAO,CAAC,MAAM;QACtB,aAAa,EAAE,OAAO,CAAC,aAAa;QACpC,SAAS,EAAE,OAAO,CAAC,SAAS;QAC5B,UAAU,EAAE,OAAO,CAAC,UAAU;QAC9B,SAAS,EAAE,OAAO,CAAC,SAAS;KAC7B,CAAC;AACJ,CAAC;AAED,SAAgB,kBAAkB,CAAC,QAAyB;IAC1D,OAAO,QAAQ;SACZ,GAAG,CAAC,iBAAiB,CAAC;SACtB,MAAM,CAAC,CAAC,GAAG,EAA2B,EAAE,CAAC,GAAG,KAAK,IAAI,CAAC,CAAC;AAC5D,CAAC","sourcesContent":["import { IGroupRequest } from '../../Interfaces/Models/i-group-request';\r\nimport { IGroupRequestDTO } from '../../Interfaces/DTOs/i-group-request-dto';\r\nimport { toGroupDTO } from './group-mapper';\r\nimport { toUserDTO } from './user-mapper';\r\nimport { IGroup } from '../../Interfaces/Models/i-group';\r\nimport { IUser } from '../../Interfaces/Models/i-user';\r\nimport logger from '../../core/utils/logger';\r\nimport { Types } from 'mongoose';\r\nimport { IUserDTO } from '../../Interfaces/DTOs/i-user-dto';\r\nimport { IGroupDTO } from '../../Interfaces/DTOs/i-group-dto';\r\n\r\nexport function toGroupRequestDTO(request: IGroupRequest | null): IGroupRequestDTO | null {\r\n  if (!request) {\r\n    logger.warn('Attempted to map null group request to DTO');\r\n    return null;\r\n  }\r\n\r\n  // Handle groupId (populated IGroup or just an ID)\r\n  let groupId: string;\r\n  let group: IGroupDTO | undefined;\r\n\r\n  if (request.groupId) {\r\n    if (typeof request.groupId === 'string') {\r\n      groupId = request.groupId;\r\n    } else if (request.groupId instanceof Types.ObjectId) {\r\n      groupId = request.groupId.toString();\r\n    } else {\r\n      // Assume it's an IGroup object (populated)\r\n      groupId = (request.groupId as IGroup)._id.toString();\r\n      const groupDTO = toGroupDTO(request.groupId as IGroup);\r\n      group = groupDTO ?? undefined; // Convert null to undefined\r\n    }\r\n  } else {\r\n    logger.warn(`Group request ${request._id} has no groupId`);\r\n    groupId = '';\r\n  }\r\n\r\n  // Handle userId (populated IUser or just an ID)\r\n  let userId: string;\r\n  let user: IUserDTO | undefined;\r\n\r\n  if (request.userId) {\r\n    if (typeof request.userId === 'string') {\r\n      userId = request.userId;\r\n    } else if (request.userId instanceof Types.ObjectId) {\r\n      userId = request.userId.toString();\r\n    } else {\r\n      // Assume it's an IUser object (populated)\r\n      userId = (request.userId as IUser)._id.toString();\r\n      const userDTO = toUserDTO(request.userId as IUser);\r\n      user = userDTO ?? undefined;\r\n    }\r\n  } else {\r\n    logger.warn(`Group request ${request._id} has no userId`);\r\n    userId = '';\r\n  }\r\n\r\n  return {\r\n    id: request._id.toString(),\r\n    groupRequestId: request.groupRequestId,\r\n    groupId,\r\n    group,\r\n    userId,\r\n    user,\r\n    status: request.status,\r\n    paymentStatus: request.paymentStatus,\r\n    paymentId: request.paymentId,\r\n    amountPaid: request.amountPaid,\r\n    createdAt: request.createdAt,\r\n  };\r\n}\r\n\r\nexport function toGroupRequestDTOs(requests: IGroupRequest[]): IGroupRequestDTO[] {\r\n  return requests\r\n    .map(toGroupRequestDTO)\r\n    .filter((dto): dto is IGroupRequestDTO => dto !== null);\r\n}\r\n"]}