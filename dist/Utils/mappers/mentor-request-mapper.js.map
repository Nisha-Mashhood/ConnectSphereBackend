{"version":3,"file":"mentor-request-mapper.js","sourceRoot":"","sources":["../../../src/Utils/mappers/mentor-request-mapper.ts"],"names":[],"mappings":"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","sourcesContent":["import { IMentorRequest } from '../../Interfaces/Models/i-mentor-request';\r\nimport { IMentorRequestDTO } from '../../Interfaces/DTOs/i-mentor-request-dto';\r\nimport { toUserDTO } from './user-mapper';\r\nimport { toMentorDTO } from './mentor-mapper';\r\nimport { IMentor } from '../../Interfaces/Models/i-mentor';\r\nimport { IUser } from '../../Interfaces/Models/i-user';\r\nimport logger from '../../core/utils/logger';\r\nimport { Types } from 'mongoose';\r\nimport { IMentorDTO } from '../../Interfaces/DTOs/i-mentor-dto';\r\nimport { IUserDTO } from '../../Interfaces/DTOs/i-user-dto';\r\n\r\nexport function toMentorRequestDTO(request: IMentorRequest | null): IMentorRequestDTO | null {\r\n  if (!request) {\r\n    logger.warn('Attempted to map null mentor request to DTO');\r\n    return null;\r\n  }\r\n\r\n  // Handle mentorId\r\n  let mentorId: string;\r\n  let mentor: IMentorDTO | undefined;\r\n\r\n  if (request.mentorId) {\r\n    if (typeof request.mentorId === 'string') {\r\n      mentorId = request.mentorId;\r\n    } else if (request.mentorId instanceof Types.ObjectId) {\r\n      mentorId = request.mentorId.toString();\r\n    } else {\r\n      // IMentor object (populated)\r\n      mentorId = (request.mentorId as IMentor)._id.toString();\r\n      const mentorDTO = toMentorDTO(request.mentorId as IMentor);\r\n      mentor = mentorDTO ?? undefined;\r\n    }\r\n  } else {\r\n    logger.warn(`Mentor request ${request._id} has no mentorId`);\r\n    mentorId = '';\r\n  }\r\n\r\n  // Handle userId\r\n  let userId: string;\r\n  let user: IUserDTO | undefined;\r\n\r\n  if (request.userId) {\r\n    if (typeof request.userId === 'string') {\r\n      userId = request.userId;\r\n    } else if (request.userId instanceof Types.ObjectId) {\r\n      userId = request.userId.toString();\r\n    } else {\r\n      // IUser object (populated)\r\n      userId = (request.userId as IUser)._id.toString();\r\n      const userDTO = toUserDTO(request.userId as IUser);\r\n      user = userDTO ?? undefined;\r\n    }\r\n  } else {\r\n    logger.warn(`Mentor request ${request._id} has no userId`);\r\n    userId = '';\r\n  }\r\n\r\n  return {\r\n    id: request._id.toString(),\r\n    mentorRequestId: request.mentorRequestId,\r\n    mentorId,\r\n    mentor,\r\n    userId,\r\n    user,\r\n    selectedSlot: request.selectedSlot\r\n      ? {\r\n          day: request.selectedSlot.day,\r\n          timeSlots: request.selectedSlot.timeSlots, \r\n        }\r\n      : undefined,\r\n    price: request.price,\r\n    paymentStatus: request.paymentStatus, \r\n    timePeriod: request.timePeriod,\r\n    isAccepted: request.isAccepted,\r\n    createdAt: request.createdAt,\r\n  };\r\n}\r\n\r\nexport function toMentorRequestDTOs(requests: IMentorRequest[]): IMentorRequestDTO[] {\r\n  return requests\r\n    .map(toMentorRequestDTO)\r\n    .filter((dto): dto is IMentorRequestDTO => dto !== null);\r\n}"]}