{"version":3,"file":"review-mapper.js","sourceRoot":"","sources":["../../../src/Utils/mappers/review-mapper.ts"],"names":[],"mappings":";;;;;AAQA,kCAqCC;AAED,oCAIC;AAjDD,+CAA0C;AAE1C,qEAA6C;AAC7C,uCAAiC;AAGjC,SAAgB,WAAW,CAAC,MAAsB;IAChD,IAAI,CAAC,MAAM,EAAE,CAAC;QACZ,gBAAM,CAAC,IAAI,CAAC,qCAAqC,CAAC,CAAC;QACnD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,wCAAwC;IACxC,IAAI,MAAc,CAAC;IACnB,IAAI,IAA0B,CAAC;IAE/B,IAAI,MAAM,CAAC,MAAM,EAAE,CAAC;QAClB,IAAI,OAAO,MAAM,CAAC,MAAM,KAAK,QAAQ,EAAE,CAAC;YACtC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;QACzB,CAAC;aAAM,IAAI,MAAM,CAAC,MAAM,YAAY,gBAAK,CAAC,QAAQ,EAAE,CAAC;YACnD,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;QACpC,CAAC;aAAM,CAAC;YACN,0BAA0B;YAC1B,MAAM,GAAI,MAAM,CAAC,MAAgB,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;YACjD,MAAM,OAAO,GAAG,IAAA,uBAAS,EAAC,MAAM,CAAC,MAAe,CAAC,CAAC;YAClD,IAAI,GAAG,OAAO,IAAI,SAAS,CAAC;QAC9B,CAAC;IACH,CAAC;SAAM,CAAC;QACN,gBAAM,CAAC,IAAI,CAAC,UAAU,MAAM,CAAC,GAAG,gBAAgB,CAAC,CAAC;QAClD,MAAM,GAAG,EAAE,CAAC;IACd,CAAC;IAED,OAAO;QACL,EAAE,EAAE,MAAM,CAAC,GAAG,CAAC,QAAQ,EAAE;QACzB,QAAQ,EAAE,MAAM,CAAC,QAAQ;QACzB,MAAM;QACN,IAAI;QACJ,MAAM,EAAE,MAAM,CAAC,MAAM;QACrB,OAAO,EAAE,MAAM,CAAC,OAAO;QACvB,UAAU,EAAE,MAAM,CAAC,UAAU;QAC7B,QAAQ,EAAE,MAAM,CAAC,QAAQ;QACzB,SAAS,EAAE,MAAM,CAAC,SAAS;KAC5B,CAAC;AACJ,CAAC;AAED,SAAgB,YAAY,CAAC,OAAkB;IAC7C,OAAO,OAAO;SACX,GAAG,CAAC,WAAW,CAAC;SAChB,MAAM,CAAC,CAAC,GAAG,EAAqB,EAAE,CAAC,GAAG,KAAK,IAAI,CAAC,CAAC;AACtD,CAAC","sourcesContent":["import { IReview } from '../../Interfaces/Models/i-review';\r\nimport { IReviewDTO } from '../../Interfaces/DTOs/i-review-dto';\r\nimport { toUserDTO } from './user-mapper';\r\nimport { IUser } from '../../Interfaces/Models/i-user';\r\nimport logger from '../../core/utils/logger';\r\nimport { Types } from 'mongoose';\r\nimport { IUserDTO } from '../../Interfaces/DTOs/i-user-dto';\r\n\r\nexport function toReviewDTO(review: IReview | null): IReviewDTO | null {\r\n  if (!review) {\r\n    logger.warn('Attempted to map null review to DTO');\r\n    return null;\r\n  }\r\n\r\n  //userId (populated IUser or just an ID)\r\n  let userId: string;\r\n  let user: IUserDTO | undefined;\r\n\r\n  if (review.userId) {\r\n    if (typeof review.userId === 'string') {\r\n      userId = review.userId;\r\n    } else if (review.userId instanceof Types.ObjectId) {\r\n      userId = review.userId.toString();\r\n    } else {\r\n      //IUser object (populated)\r\n      userId = (review.userId as IUser)._id.toString();\r\n      const userDTO = toUserDTO(review.userId as IUser);\r\n      user = userDTO ?? undefined;\r\n    }\r\n  } else {\r\n    logger.warn(`Review ${review._id} has no userId`);\r\n    userId = '';\r\n  }\r\n\r\n  return {\r\n    id: review._id.toString(),\r\n    reviewId: review.reviewId,\r\n    userId,\r\n    user,\r\n    rating: review.rating,\r\n    comment: review.comment,\r\n    isApproved: review.isApproved,\r\n    isSelect: review.isSelect,\r\n    createdAt: review.createdAt,\r\n  };\r\n}\r\n\r\nexport function toReviewDTOs(reviews: IReview[]): IReviewDTO[] {\r\n  return reviews\r\n    .map(toReviewDTO)\r\n    .filter((dto): dto is IReviewDTO => dto !== null);\r\n}"]}