{"version":3,"file":"skill-mapper.js","sourceRoot":"","sources":["../../../src/Utils/mappers/skill-mapper.ts"],"names":[],"mappings":";;;;;AAWA,gCAuDC;AAED,kCAIC;AApED,uDAAkD;AAClD,6DAAwD;AACxD,qEAA6C;AAC7C,uCAAiC;AAIjC,SAAgB,UAAU,CAAC,KAAoB;IAC7C,IAAI,CAAC,KAAK,EAAE,CAAC;QACX,gBAAM,CAAC,IAAI,CAAC,oCAAoC,CAAC,CAAC;QAClD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,IAAI,UAAkB,CAAC;IACvB,IAAI,QAAkC,CAAC;IACvC,IAAI,KAAK,CAAC,UAAU,EAAE,CAAC;QACrB,IAAI,OAAO,KAAK,CAAC,UAAU,KAAK,QAAQ,EAAE,CAAC;YACzC,UAAU,GAAG,KAAK,CAAC,UAAU,CAAC;QAChC,CAAC;aAAM,IAAI,KAAK,CAAC,UAAU,YAAY,gBAAK,CAAC,QAAQ,EAAE,CAAC;YACtD,UAAU,GAAG,KAAK,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;QAC3C,CAAC;aAAM,CAAC;YACN,8BAA8B;YAC9B,UAAU,GAAI,KAAK,CAAC,UAAwB,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;YAC5D,MAAM,WAAW,GAAG,IAAA,+BAAa,EAAC,KAAK,CAAC,UAAuB,CAAC,CAAC;YACjE,QAAQ,GAAG,WAAW,IAAI,SAAS,CAAC;QACtC,CAAC;IACH,CAAC;SAAM,CAAC;QACN,gBAAM,CAAC,IAAI,CAAC,SAAS,KAAK,CAAC,GAAG,oBAAoB,CAAC,CAAC;QACpD,UAAU,GAAG,EAAE,CAAC;IAClB,CAAC;IAED,IAAI,aAAqB,CAAC;IAC1B,IAAI,WAAwC,CAAC;IAC7C,IAAI,KAAK,CAAC,aAAa,EAAE,CAAC;QACxB,IAAI,OAAO,KAAK,CAAC,aAAa,KAAK,QAAQ,EAAE,CAAC;YAC5C,aAAa,GAAG,KAAK,CAAC,aAAa,CAAC;QACtC,CAAC;aAAM,IAAI,KAAK,CAAC,aAAa,YAAY,gBAAK,CAAC,QAAQ,EAAE,CAAC;YACzD,aAAa,GAAG,KAAK,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC;QACjD,CAAC;aAAM,CAAC;YACN,iCAAiC;YACjC,aAAa,GAAI,KAAK,CAAC,aAA8B,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;YACrE,MAAM,cAAc,GAAG,IAAA,qCAAgB,EAAC,KAAK,CAAC,aAA6B,CAAC,CAAC;YAC7E,WAAW,GAAG,cAAc,IAAI,SAAS,CAAC;QAC5C,CAAC;IACH,CAAC;SAAM,CAAC;QACN,gBAAM,CAAC,IAAI,CAAC,SAAS,KAAK,CAAC,GAAG,uBAAuB,CAAC,CAAC;QACvD,aAAa,GAAG,EAAE,CAAC;IACrB,CAAC;IAED,OAAO;QACL,EAAE,EAAE,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE;QACxB,OAAO,EAAE,KAAK,CAAC,OAAO;QACtB,IAAI,EAAE,KAAK,CAAC,IAAI;QAChB,UAAU;QACV,QAAQ;QACR,aAAa;QACb,WAAW;QACX,WAAW,EAAE,KAAK,CAAC,WAAW;QAC9B,QAAQ,EAAE,KAAK,CAAC,QAAQ,IAAI,SAAS;QACrC,SAAS,EAAE,KAAK,CAAC,SAAS;QAC1B,SAAS,EAAE,KAAK,CAAC,SAAS;KAC3B,CAAC;AACJ,CAAC;AAED,SAAgB,WAAW,CAAC,MAAgB;IAC1C,OAAO,MAAM;SACV,GAAG,CAAC,UAAU,CAAC;SACf,MAAM,CAAC,CAAC,GAAG,EAAoB,EAAE,CAAC,GAAG,KAAK,IAAI,CAAC,CAAC;AACrD,CAAC","sourcesContent":["import { ISkill } from '../../Interfaces/Models/i-skill';\r\nimport { ISkillDTO } from '../../Interfaces/DTOs/i-skill-dto';\r\nimport { ICategory } from '../../Interfaces/Models/i-category';\r\nimport { ISubcategory } from '../../Interfaces/Models/i-sub-category';\r\nimport { toCategoryDTO } from './category-mapper';\r\nimport { toSubcategoryDTO } from './subcategory-mapper';\r\nimport logger from '../../core/utils/logger';\r\nimport { Types } from 'mongoose';\r\nimport { ISubcategoryDTO } from '../../Interfaces/DTOs/i-sub-category-dto';\r\nimport { ICategoryDTO } from '../../Interfaces/DTOs/i-category-dto';\r\n\r\nexport function toSkillDTO(skill: ISkill | null): ISkillDTO | null {\r\n  if (!skill) {\r\n    logger.warn('Attempted to map null skill to DTO');\r\n    return null;\r\n  }\r\n\r\n  let categoryId: string;\r\n  let category: ICategoryDTO | undefined;\r\n  if (skill.categoryId) {\r\n    if (typeof skill.categoryId === 'string') {\r\n      categoryId = skill.categoryId;\r\n    } else if (skill.categoryId instanceof Types.ObjectId) {\r\n      categoryId = skill.categoryId.toString();\r\n    } else {\r\n      //ICategory object (populated)\r\n      categoryId = (skill.categoryId as ICategory)._id.toString();\r\n      const categoryDTO = toCategoryDTO(skill.categoryId as ICategory);\r\n      category = categoryDTO ?? undefined;\r\n    }\r\n  } else {\r\n    logger.warn(`Skill ${skill._id} has no categoryId`);\r\n    categoryId = '';\r\n  }\r\n\r\n  let subcategoryId: string;\r\n  let subcategory: ISubcategoryDTO | undefined;\r\n  if (skill.subcategoryId) {\r\n    if (typeof skill.subcategoryId === 'string') {\r\n      subcategoryId = skill.subcategoryId;\r\n    } else if (skill.subcategoryId instanceof Types.ObjectId) {\r\n      subcategoryId = skill.subcategoryId.toString();\r\n    } else {\r\n      //ISubcategory object (populated)\r\n      subcategoryId = (skill.subcategoryId as ISubcategory)._id.toString();\r\n      const subcategoryDTO = toSubcategoryDTO(skill.subcategoryId as ISubcategory);\r\n      subcategory = subcategoryDTO ?? undefined;\r\n    }\r\n  } else {\r\n    logger.warn(`Skill ${skill._id} has no subcategoryId`);\r\n    subcategoryId = '';\r\n  }\r\n\r\n  return {\r\n    id: skill._id.toString(),\r\n    skillId: skill.skillId,\r\n    name: skill.name,\r\n    categoryId,\r\n    category,\r\n    subcategoryId,\r\n    subcategory,\r\n    description: skill.description,\r\n    imageUrl: skill.imageUrl ?? undefined,\r\n    createdAt: skill.createdAt,\r\n    updatedAt: skill.updatedAt,\r\n  };\r\n}\r\n\r\nexport function toSkillDTOs(skills: ISkill[]): ISkillDTO[] {\r\n  return skills\r\n    .map(toSkillDTO)\r\n    .filter((dto): dto is ISkillDTO => dto !== null);\r\n}"]}