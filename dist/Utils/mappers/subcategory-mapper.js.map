{"version":3,"file":"subcategory-mapper.js","sourceRoot":"","sources":["../../../src/Utils/mappers/subcategory-mapper.ts"],"names":[],"mappings":";;;;;AAQA,4CAoCC;AAED,8CAIC;AA/CD,uDAAkD;AAClD,qEAA6C;AAC7C,uCAAiC;AAGjC,SAAgB,gBAAgB,CAAC,WAAgC;IAC/D,IAAI,CAAC,WAAW,EAAE,CAAC;QACjB,gBAAM,CAAC,IAAI,CAAC,0CAA0C,CAAC,CAAC;QACxD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,IAAI,UAAkB,CAAC;IACvB,IAAI,QAAkC,CAAC;IAEvC,IAAI,WAAW,CAAC,UAAU,EAAE,CAAC;QAC3B,IAAI,OAAO,WAAW,CAAC,UAAU,KAAK,QAAQ,EAAE,CAAC;YAC/C,UAAU,GAAG,WAAW,CAAC,UAAU,CAAC;QACtC,CAAC;aAAM,IAAI,WAAW,CAAC,UAAU,YAAY,gBAAK,CAAC,QAAQ,EAAE,CAAC;YAC5D,UAAU,GAAG,WAAW,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;QACjD,CAAC;aAAM,CAAC;YACN,8BAA8B;YAC9B,UAAU,GAAI,WAAW,CAAC,UAAwB,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;YAClE,MAAM,WAAW,GAAG,IAAA,+BAAa,EAAC,WAAW,CAAC,UAAuB,CAAC,CAAC;YACvE,QAAQ,GAAG,WAAW,IAAI,SAAS,CAAC;QACtC,CAAC;IACH,CAAC;SAAM,CAAC;QACN,gBAAM,CAAC,IAAI,CAAC,eAAe,WAAW,CAAC,GAAG,oBAAoB,CAAC,CAAC;QAChE,UAAU,GAAG,EAAE,CAAC;IAClB,CAAC;IAED,OAAO;QACL,EAAE,EAAE,WAAW,CAAC,GAAG,CAAC,QAAQ,EAAE;QAC9B,aAAa,EAAE,WAAW,CAAC,aAAa;QACxC,IAAI,EAAE,WAAW,CAAC,IAAI;QACtB,UAAU;QACV,QAAQ;QACR,WAAW,EAAE,WAAW,CAAC,WAAW;QACpC,QAAQ,EAAE,WAAW,CAAC,QAAQ,IAAI,SAAS;QAC3C,SAAS,EAAE,WAAW,CAAC,SAAS;QAChC,SAAS,EAAE,WAAW,CAAC,SAAS;KACjC,CAAC;AACJ,CAAC;AAED,SAAgB,iBAAiB,CAAC,aAA6B;IAC7D,OAAO,aAAa;SACjB,GAAG,CAAC,gBAAgB,CAAC;SACrB,MAAM,CAAC,CAAC,GAAG,EAA0B,EAAE,CAAC,GAAG,KAAK,IAAI,CAAC,CAAC;AAC3D,CAAC","sourcesContent":["import { ISubcategory } from '../../Interfaces/Models/i-sub-category';\r\nimport { ISubcategoryDTO } from '../../Interfaces/DTOs/i-sub-category-dto';\r\nimport { ICategory } from '../../Interfaces/Models/i-category';\r\nimport { toCategoryDTO } from './category-mapper';\r\nimport logger from '../../core/utils/logger';\r\nimport { Types } from 'mongoose';\r\nimport { ICategoryDTO } from '../../Interfaces/DTOs/i-category-dto';\r\n\r\nexport function toSubcategoryDTO(subcategory: ISubcategory | null): ISubcategoryDTO | null {\r\n  if (!subcategory) {\r\n    logger.warn('Attempted to map null subcategory to DTO');\r\n    return null;\r\n  }\r\n\r\n  let categoryId: string;\r\n  let category: ICategoryDTO | undefined;\r\n\r\n  if (subcategory.categoryId) {\r\n    if (typeof subcategory.categoryId === 'string') {\r\n      categoryId = subcategory.categoryId;\r\n    } else if (subcategory.categoryId instanceof Types.ObjectId) {\r\n      categoryId = subcategory.categoryId.toString();\r\n    } else {\r\n      //ICategory object (populated)\r\n      categoryId = (subcategory.categoryId as ICategory)._id.toString();\r\n      const categoryDTO = toCategoryDTO(subcategory.categoryId as ICategory);\r\n      category = categoryDTO ?? undefined;\r\n    }\r\n  } else {\r\n    logger.warn(`Subcategory ${subcategory._id} has no categoryId`);\r\n    categoryId = '';\r\n  }\r\n\r\n  return {\r\n    id: subcategory._id.toString(),\r\n    subcategoryId: subcategory.subcategoryId,\r\n    name: subcategory.name,\r\n    categoryId,\r\n    category,\r\n    description: subcategory.description,\r\n    imageUrl: subcategory.imageUrl ?? undefined,\r\n    createdAt: subcategory.createdAt,\r\n    updatedAt: subcategory.updatedAt,\r\n  };\r\n}\r\n\r\nexport function toSubcategoryDTOs(subcategories: ISubcategory[]): ISubcategoryDTO[] {\r\n  return subcategories\r\n    .map(toSubcategoryDTO)\r\n    .filter((dto): dto is ISubcategoryDTO => dto !== null);\r\n}"]}