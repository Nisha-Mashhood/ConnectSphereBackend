{"version":3,"file":"auth-types.js","sourceRoot":"","sources":["../../../src/Utils/types/auth-types.ts"],"names":[],"mappings":"","sourcesContent":["import { IUserDTO } from '../../Interfaces/DTOs/i-user-dto';\r\nimport { IUser } from '../../Interfaces/Models/i-user';\r\nimport { Request } from \"express\";\r\n\r\n//Types for controller file \r\n\r\n// Interface for signup request body\r\nexport interface SignupRequestBody {\r\n  name: string;\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\n// Interface for login request body\r\nexport interface LoginRequestBody {\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\n// Interface for OAuth request body\r\nexport interface OAuthRequestBody {\r\n  code: string;\r\n}\r\n\r\n// Interface for refresh token request body\r\nexport interface RefreshTokenRequestBody {\r\n  refreshToken: string;\r\n}\r\n\r\n// Interface for forgot password request body\r\nexport interface ForgotPasswordRequestBody {\r\n  email: string;\r\n}\r\n\r\n// Interface for verify OTP request body\r\nexport interface VerifyOTPRequestBody {\r\n  purpose: OtpPurpose,\r\n  email: string;\r\n  otpId: string,\r\n  otp: string;\r\n}\r\n\r\n// Interface for reset password request body\r\nexport interface ResetPasswordRequestBody {\r\n  email: string;\r\n  newPassword: string;\r\n}\r\n\r\n// Interface for logout request body\r\nexport interface LogoutRequestBody {\r\n  email: string;\r\n}\r\n\r\n// Interface for verify passkey request body\r\nexport interface VerifyPasskeyRequestBody {\r\n  passkey: string;\r\n}\r\n\r\n// Interface for update profile request body\r\nexport interface UpdateProfileRequestBody extends Partial<IUser> {\r\n  profilePicFile?: Request[\"file\"];\r\n  coverPicFile?: Request[\"file\"];\r\n}\r\n\r\n\r\n//Types for service file\r\n\r\n// Interface for signup data\r\nexport interface SignupData {\r\n  name: string;\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\n// Interface for profile update data\r\nexport interface ProfileUpdateData extends Partial<IUser> {\r\n  profilePicFile?: Request[\"file\"];\r\n  coverPicFile?: Request[\"file\"];\r\n}\r\n\r\n//Interface for Query for User Retrievel\r\nexport type UserQuery = {\r\n  search?: string;\r\n  sortField?: 'industry' | 'reasonForJoining' | 'hasReviewed';\r\n  sortOrder?: 'asc' | 'desc';\r\n  page?: number;\r\n  limit?: number;\r\n  excludeId?: string;\r\n  status?: string;\r\n};\r\n\r\n//Upadte Password \r\nexport interface UpdatePasswordRequestBody {\r\n  currentPassword: string;\r\n  newPassword: string;\r\n}\r\n\r\n //OTP types\r\nexport type OtpPurpose =\r\n  | \"signup\"\r\n  | \"login\"\r\n  | \"forgot-password\"\r\n  | \"google-login\"\r\n  | \"github-login\"\r\n  | \"forgot_password\";\r\n\r\n//OTP structure stored in Redis\r\nexport interface OtpRedisPayload {\r\n  otp: string;\r\n  email: string;\r\n  purpose: OtpPurpose;\r\n  attempts: number;\r\n  createdAt: number;\r\n}\r\n\r\n//structure for sending OTP\r\nexport interface SendOtpParams {\r\n  email: string;\r\n  purpose: OtpPurpose;\r\n  emailSubject: string;\r\n  emailBody: (otp: string) => string;\r\n  ttlSeconds?: number;\r\n}\r\n\r\nexport interface VerifyOtpLoginResult {\r\n  purpose: \"login\";\r\n  user: IUserDTO;\r\n  accessToken: string;\r\n  refreshToken: string;\r\n  needsReviewPrompt: boolean;\r\n}\r\n\r\nexport interface VerifyOtpGenericResult {\r\n  purpose: Exclude<OtpPurpose, \"login\">;\r\n  email: string;\r\n}\r\n\r\nexport type VerifyOtpResult =\r\n  | VerifyOtpLoginResult\r\n  | VerifyOtpGenericResult;"]}