{"version":3,"file":"o-t-p.js","sourceRoot":"","sources":["../../../../src/Utils/utils/auth-utils/o-t-p.ts"],"names":[],"mappings":";;;AACA,yDAAoD;AACpD,qDAAsD;AAE/C,MAAM,WAAW,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,cAAc;AAA1F,QAAA,WAAW,eAAgE;AAEjF,MAAM,eAAe,GAAG,KAAK,EAClC,MAAqB,EACJ,EAAE;IACnB,MAAM,EACJ,KAAK,EACL,OAAO,EACP,YAAY,EACZ,SAAS,EACT,UAAU,GAAG,GAAG,GACjB,GAAG,MAAM,CAAC;IAEX,MAAM,eAAe,GAAW,KAAK,CAAC,WAAW,EAAE,CAAC,IAAI,EAAE,CAAC;IAC3D,gCAAgC;IAGhC,MAAM,GAAG,GAAW,IAAA,mBAAW,GAAE,CAAC,CAAI,cAAc;IACpD,MAAM,KAAK,GAAW,MAAM,IAAA,iCAAc,EAAK,eAAe;IAC5D;QACE,GAAG;QACH,KAAK,EAAE,eAAe;QACtB,OAAO;QACP,QAAQ,EAAE,CAAC;QACX,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;KACtB,EACD,UAAU,CACX,CAAC;IACF,MAAM,IAAA,iBAAS,EAAG,YAAY;IAC5B,eAAe,EACf,YAAY,EACZ,SAAS,CAAC,GAAG,CAAC,CACf,CAAC;IAEF,OAAO,CAAC,GAAG,CAAC,yBAAyB,EAAC,GAAG,CAAC,CAAA;IAE1C,OAAO,KAAK,CAAC;AACf,CAAC,CAAC;AAnCW,QAAA,eAAe,mBAmC1B","sourcesContent":["import { SendOtpParams } from \"../../types/auth-types\";\r\nimport { saveOtpToRedis } from \"./otp-redis-helper\";\r\nimport { sendEmail } from \"../../../core/utils/email\";\r\n\r\nexport const generateOTP = () => Math.floor(100000 + Math.random() * 900000).toString(); // 6-digit OTP\r\n\r\nexport const sendOtpAndStore = async (\r\n  params: SendOtpParams\r\n): Promise<string> => {\r\n  const {\r\n    email,\r\n    purpose,\r\n    emailSubject,\r\n    emailBody,\r\n    ttlSeconds = 300,\r\n  } = params;\r\n\r\n  const normalizedEmail: string = email.toLowerCase().trim();\r\n  // const todayDate = new Date();\r\n  \r\n\r\n  const otp: string = generateOTP();    //generate otp\r\n  const otpId: string = await saveOtpToRedis(    //save to redis\r\n    {\r\n      otp,\r\n      email: normalizedEmail,\r\n      purpose,\r\n      attempts: 0,\r\n      createdAt: Date.now(),\r\n    },\r\n    ttlSeconds\r\n  );\r\n  await sendEmail(  //send email\r\n    normalizedEmail,\r\n    emailSubject,\r\n    emailBody(otp)\r\n  );\r\n\r\n  console.log(\"OTP SENT SUCCESSFULLY :\",otp)\r\n\r\n  return otpId;\r\n};"]}