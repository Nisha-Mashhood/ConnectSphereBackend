{"version":3,"file":"call-controller.js","sourceRoot":"","sources":["../../src/controllers/call-controller.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AACA,wEAAoE;AACpE,kEAA0C;AAE1C,+DAAwD;AAExD,kEAAyD;AAEzD,yCAA+C;AAC/C,gEAA6D;AAC7D,oDAAsD;AAG/C,IAAM,cAAc,GAApB,MAAM,cAAe,SAAQ,gCAAc;IAGhD,YAAoC,WAA0B;QAC5D,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;IAClC,CAAC;IAED,KAAK,CAAC,mBAAmB,CAAC,GAAY,EAAE,GAAa,EAAE,IAAkB;QACvE,IAAI,CAAC;YACH,MAAM,MAAM,GAAG,GAAG,CAAC,WAAW,EAAE,GAAG,CAAC;YAEpC,IAAI,CAAC,MAAM,EAAE,CAAC;gBACZ,gBAAM,CAAC,KAAK,CAAC,iCAAiC,CAAC,CAAC;gBAChD,MAAM,IAAI,yBAAS,CAAC,+BAAc,CAAC,gBAAgB,EAAE,+BAAW,CAAC,WAAW,CAAC,CAAC;YAChF,CAAC;YAED,gBAAM,CAAC,KAAK,CAAC,iDAAiD,MAAM,EAAE,CAAC,CAAC;YACxE,MAAM,QAAQ,GAAwB,MAAM,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,MAAM,EAAE,QAAQ,EAAE,CAAC,CAAC;YACtG,IAAI,QAAQ,EAAE,CAAC;gBACb,gBAAM,CAAC,IAAI,CAAC,qBAAqB,EAAE,QAAQ,CAAC,CAAC;YAC/C,CAAC;YAED,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;gBAC1B,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,EAAE,EAAE,wBAAa,CAAC,kBAAkB,CAAC,CAAC;gBAC5D,gBAAM,CAAC,IAAI,CAAC,kCAAkC,MAAM,EAAE,CAAC,CAAC;gBACxD,OAAO;YACT,CAAC;YAED,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,QAAQ,EAAE,wBAAa,CAAC,mBAAmB,CAAC,CAAC;QACrE,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACpB,gBAAM,CAAC,KAAK,CAAC,gDAAgD,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;YAC9E,IAAI,CAAC,KAAK,CAAC,CAAC;QACd,CAAC;IACH,CAAC;CACF,CAAA;AAnCY,wCAAc;yBAAd,cAAc;IAD1B,IAAA,sBAAU,GAAE;IAIE,WAAA,IAAA,kBAAM,EAAC,cAAc,CAAC,CAAA;;GAHxB,cAAc,CAmC1B","sourcesContent":["import { Request, Response, NextFunction } from \"express\";\r\nimport { BaseController } from \"../core/controller/base-controller\";\r\nimport logger from \"../core/utils/logger\";\r\nimport { ICallController } from \"../Interfaces/Controller/i-call-controller\";\r\nimport { HttpError } from \"../core/utils/error-handler\";\r\nimport { ICallLogPopulated } from \"../Utils/types/call-types\";\r\nimport { StatusCodes } from \"../enums/status-code-enums\";\r\nimport { ICallService } from \"../Interfaces/Services/i-call-service\";\r\nimport { inject, injectable } from \"inversify\";\r\nimport { ERROR_MESSAGES } from \"../constants/error-messages\";\r\nimport { CALL_MESSAGES } from \"../constants/messages\";\r\n\r\n@injectable()\r\nexport class CallController extends BaseController implements ICallController{\r\n  private _callService: ICallService;\r\n\r\n  constructor(@inject('ICallService') callService : ICallService) {\r\n    super();\r\n    this._callService = callService;\r\n  }\r\n\r\n  async getCallLogsByUserId(req: Request, res: Response, next: NextFunction): Promise<void> {\r\n    try {\r\n      const userId = req.currentUser?._id;\r\n\r\n      if (!userId) {\r\n        logger.error(\"User ID not provided in request\");\r\n        throw new HttpError(ERROR_MESSAGES.REQUIRED_USER_ID, StatusCodes.BAD_REQUEST);\r\n      }\r\n\r\n      logger.debug(`Handling request to get call logs for userId: ${userId}`);\r\n      const callLogs: ICallLogPopulated[] = await this._callService.getCallLogsByUserId(userId?.toString());\r\n      if (callLogs) {\r\n        logger.info(\"call Log fetched : \", callLogs);\r\n      }\r\n\r\n      if (callLogs.length === 0) {\r\n        this.sendSuccess(res, [], CALL_MESSAGES.NO_CALL_LOGS_FOUND);\r\n        logger.info(`No call logs found for userId: ${userId}`);\r\n        return;\r\n      }\r\n\r\n      this.sendSuccess(res, callLogs, CALL_MESSAGES.CALL_LOGS_RETRIEVED);\r\n    } catch (error: any) {\r\n      logger.error(`Error in CallController.getCallLogsByUserId: ${error.message}`);\r\n      next(error);\r\n    }\r\n  }\r\n}"]}