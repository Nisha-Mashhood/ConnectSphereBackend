{"version":3,"file":"clean-up-repositry.js","sourceRoot":"","sources":["../../../src/core/repositries/clean-up-repositry.ts"],"names":[],"mappings":";;;;;;AAAA,0DAAyD;AACzD,6DAAqC;AACrC,2FAA4D;AAC5D,6FAA8D;AAC9D,mEAAgE;AAEhE,MAAa,iBAAiB;IAA9B;QACE,oCAAoC;QACpC,2BAAsB,GAAG,KAAK,EAAE,UAAgB,EAAmB,EAAE;YACnE,IAAI,CAAC;gBACH,gBAAM,CAAC,KAAK,CAAC,8CAA8C,UAAU,EAAE,CAAC,CAAC;gBACzE,MAAM,MAAM,GAAG,MAAM,6BAAY,CAAC,UAAU,CAAC;oBAC3C,SAAS,EAAE,EAAE,GAAG,EAAE,UAAU,EAAE;iBAC/B,CAAC,CAAC,IAAI,EAAE,CAAC;gBACV,gBAAM,CAAC,IAAI,CAAC,WAAW,MAAM,CAAC,YAAY,6BAA6B,CAAC,CAAC;gBACzE,OAAO,MAAM,CAAC,YAAY,IAAI,CAAC,CAAC;YAClC,CAAC;YAAC,OAAO,KAAU,EAAE,CAAC;gBACpB,gBAAM,CAAC,KAAK,CAAC,gDAAgD,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;gBAC9E,MAAM,IAAI,+BAAe,CAAC,+BAAc,CAAC,mCAAmC,CAAC,CAAC;YAChF,CAAC;QACH,CAAC,CAAA;QAED,qCAAqC;QACrC,4BAAuB,GAAG,KAAK,EAAE,UAAgB,EAAmB,EAAE;YACpE,IAAI,CAAC;gBACH,gBAAM,CAAC,KAAK,CAAC,+CAA+C,UAAU,EAAE,CAAC,CAAC;gBAC1E,MAAM,MAAM,GAAG,MAAM,8BAAa,CAAC,UAAU,CAAC;oBAC5C,SAAS,EAAE,EAAE,GAAG,EAAE,UAAU,EAAE;iBAC/B,CAAC,CAAC,IAAI,EAAE,CAAC;gBACV,gBAAM,CAAC,IAAI,CAAC,WAAW,MAAM,CAAC,YAAY,8BAA8B,CAAC,CAAC;gBAC1E,OAAO,MAAM,CAAC,YAAY,IAAI,CAAC,CAAC;YAClC,CAAC;YAAC,OAAO,KAAU,EAAE,CAAC;gBACpB,gBAAM,CAAC,KAAK,CAAC,iDAAiD,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;gBAC/E,MAAM,IAAI,+BAAe,CAAC,+BAAc,CAAC,oCAAoC,CAAC,CAAC;YACjF,CAAC;QACH,CAAC,CAAA;IACH,CAAC;CAAA;AA9BD,8CA8BC","sourcesContent":["import { RepositoryError } from \"../utils/error-handler\";\r\nimport logger from \"../utils/logger\";\r\nimport GroupRequest from \"../../Models/group-request-model\";\r\nimport MentorRequest from \"../../Models/mentor-requset-model\";\r\nimport { ERROR_MESSAGES } from \"../../constants/error-messages\";\r\n\r\nexport class CleanupRepository {\r\n  // Delete old GroupRequest Documents\r\n  deleteOldGroupRequests = async (cutoffDate: Date): Promise<number> => {\r\n    try {\r\n      logger.debug(`Deleting GroupRequest documents older than ${cutoffDate}`);\r\n      const result = await GroupRequest.deleteMany({\r\n        updatedAt: { $lt: cutoffDate },\r\n      }).exec();\r\n      logger.info(`Deleted ${result.deletedCount} old GroupRequest documents`);\r\n      return result.deletedCount || 0;\r\n    } catch (error: any) {\r\n      logger.error(`Failed to delete old GroupRequest documents: ${error.message}`);\r\n      throw new RepositoryError(ERROR_MESSAGES.FAILED_TO_DELETE_OLD_GROUP_REQUESTS);\r\n    }\r\n  }\r\n\r\n  // Delete old MentorRequest Documents\r\n  deleteOldMentorRequests = async (cutoffDate: Date): Promise<number> => {\r\n    try {\r\n      logger.debug(`Deleting MentorRequest documents older than ${cutoffDate}`);\r\n      const result = await MentorRequest.deleteMany({\r\n        updatedAt: { $lt: cutoffDate },\r\n      }).exec();\r\n      logger.info(`Deleted ${result.deletedCount} old MentorRequest documents`);\r\n      return result.deletedCount || 0;\r\n    } catch (error: any) {\r\n      logger.error(`Failed to delete old MentorRequest documents: ${error.message}`);\r\n      throw new RepositoryError(ERROR_MESSAGES.FAILED_TO_DELETE_OLD_MENTOR_REQUESTS);\r\n    }\r\n  }\r\n}"]}