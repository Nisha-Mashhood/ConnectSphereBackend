{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"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","sourcesContent":["import \"reflect-metadata\";\r\nimport express from \"express\";\r\nimport connectDB from \"./config/db-config\";\r\nimport config from \"./config/env-config\";\r\nimport authRoutes from \"./Routes/Routes/auth-routes\";\r\nimport cors from \"cors\";\r\nimport cookieParser from \"cookie-parser\";\r\nimport http from \"http\";\r\nimport { Server } from \"socket.io\";\r\nimport { CleanupScheduler } from \"./core/utils/notification-scheduler\";\r\nimport logger from \"./core/utils/logger\";\r\nimport categoryRoutes from \"./Routes/Routes/category-routes\";\r\nimport subCategoryRoutes from \"./Routes/Routes/sub-category-routes\";\r\nimport skillsRoutes from \"./Routes/Routes/skills-routes\";\r\nimport mentorRoutes from \"./Routes/Routes/mentor-routes\";\r\nimport collaborationRoutes from \"./Routes/Routes/collaboration-routes\";\r\nimport groupRoutes from \"./Routes/Routes/group-routes\";\r\nimport feedbackRoutes from './Routes/Routes/feedback-routes';\r\nimport user_userCollabRoutes from './Routes/Routes/user-collaboration-routes';\r\nimport taskRoutes from './Routes/Routes/task-routes';\r\nimport  notificationRoutes from './Routes/Routes/notification-routes';\r\nimport adminRoutes from './Routes/Routes/admin-dashboard-routes';\r\nimport chatRoutes from \"./Routes/Routes/chat-routes\";\r\nimport contactsRoutes from \"./Routes/Routes/contact-routes\";\r\nimport reviewsRoutes from \"./Routes/Routes/review-routes\";\r\nimport contactUsRoutes from \"./Routes/Routes/contact-us-routes\";\r\nimport callLogRoutes from \"./Routes/Routes/call-routes\";\r\nimport { errorHandler } from \"./middlewares/error-handler-middleware\";\r\nimport container from \"./container\";\r\nimport { ISocketService } from \"./Interfaces/Services/i-socket-service\";\r\nconst PORT = Number(config.port) || 3000;\r\nconst app = express();\r\nconst server: http.Server = http.createServer(app);\r\n\r\n// Connect to DB and run cleanup\r\nconst startServer = async () => {\r\n  if (!config.mongoURI) {\r\n    logger.warn(\"MongoDB URI not found. Skipping DB connection.\");\r\n  } else {\r\n    await connectDB();\r\n  } \r\n\r\n  // Middleware\r\n  app.use(express.json());\r\n  app.use(cookieParser());\r\n  app.use(cors({\r\n    origin: config.frontendurl || \"http://localhost:8089\",\r\n    credentials: true,\r\n  }));\r\n\r\n\r\n  // Routes\r\n  app.use(\"/api/auth\", authRoutes);\r\n  app.use(\"/api/category\", categoryRoutes);\r\n  app.use(\"/api/subcategory\", subCategoryRoutes);\r\n  app.use(\"/api/skills\", skillsRoutes);\r\n  app.use(\"/api/mentors\", mentorRoutes);\r\n  app.use(\"/api/collaboration\", collaborationRoutes);\r\n  app.use(\"/api/group\", groupRoutes);\r\n  app.use(\"/api/feedback\", feedbackRoutes);\r\n  app.use(\"/api/user-userCollab\", user_userCollabRoutes);\r\n  app.use(\"/api/task\", taskRoutes);\r\n  app.use(\"/api/notification\", notificationRoutes);\r\n  app.use(\"/api/admin\", adminRoutes);\r\n  app.use(\"/api/chat\", chatRoutes);\r\n  app.use(\"/api/contacts\", contactsRoutes);\r\n  app.use(\"/api/reviews\", reviewsRoutes);\r\n  app.use(\"/api/contactUs\", contactUsRoutes);\r\n  app.use(\"/api/callLog\",callLogRoutes);\r\n\r\n  // Placeholder route\r\n  app.get(\"/\", (_req, res) => {\r\n    res.send(\"Connect Sphere Backend is running!\");\r\n  });\r\n\r\n    app.use(errorHandler);\r\n\r\n\r\n  // Initialize Socket.IO\r\n  const io = new Server(server, {\r\n    cors: {\r\n      origin: config.frontendurl || \"http://localhost:8089\",\r\n      methods: [\"GET\", \"POST\"],\r\n      credentials: true,\r\n    },\r\n  });\r\n  const socketService =container.get<ISocketService>('ISocketService');\r\n  socketService.initialize(io);\r\n\r\n  // Schedule Node cron tasks\r\n  const cleanupScheduler = new CleanupScheduler();\r\n  cleanupScheduler.start();\r\n\r\n  // Start server\r\n  server.listen(PORT, '0.0.0.0', () => {\r\n    logger.info(`Server running on port ${PORT}`);\r\n  });\r\n};\r\n\r\n// Start the server\r\nstartServer();\r\n"]}