{"version":3,"file":"admin-dashboard-service.js","sourceRoot":"","sources":["../../src/services/admin-dashboard-service.ts"],"names":[],"mappings":"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","sourcesContent":["import { inject, injectable } from \"inversify\";\r\nimport logger from \"../core/utils/logger\";\r\nimport { ServiceError } from \"../core/utils/error-handler\";\r\nimport { StatusCodes } from \"../enums/status-code-enums\";\r\nimport { IAdminService } from \"../Interfaces/Services/i-admin-service\";\r\nimport {\r\n  RevenueStats,\r\n  RevenueTrend,\r\n  TopMentor,\r\n  UserGrowth,\r\n} from \"../Utils/types/admin-types\";\r\nimport { IAdminRepository } from \"../Interfaces/Repository/i-admin-repositry\";\r\nimport { toMentorDTOs } from \"../Utils/mappers/mentor-mapper\";\r\nimport { IMentorDTO } from \"../Interfaces/DTOs/i-mentor-dto\";\r\nimport { toCollaborationDTOs } from \"../Utils/mappers/collaboration-mapper\";\r\nimport { ICollaborationDTO } from \"../Interfaces/DTOs/i-collaboration-dto\";\r\nimport { ProfileUpdateData } from \"../Utils/types/auth-types\";\r\nimport { IUserRepository } from \"../Interfaces/Repository/i-user-repositry\";\r\nimport { IUserAdminDTO } from \"../Interfaces/DTOs/i-user-dto\";\r\nimport { toUserAdminDTO } from \"../Utils/mappers/user-mapper\";\r\nimport { uploadMedia } from \"../core/utils/cloudinary\";\r\nimport { IUser } from \"../Interfaces/Models/i-user\";\r\n\r\n@injectable()\r\nexport class AdminService implements IAdminService {\r\n  private _adminRepository: IAdminRepository;\r\n  private _userRepository: IUserRepository;\r\n  \r\n    constructor(\r\n      @inject('IAdminRepository') adminRepository : IAdminRepository,\r\n      @inject('IUserRepository') userRepository :IUserRepository,\r\n    ) {\r\n      this._userRepository =  userRepository;\r\n      this._adminRepository = adminRepository;\r\n      \r\n\r\n    }\r\n  getTotalUsersCount = async (): Promise<number> => {\r\n    try {\r\n      const count = await this._adminRepository.getTotalUsersCount();\r\n      return count;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(\"Error in getTotalUsersCount\", err);\r\n      throw new ServiceError(\r\n        \"Failed to fetch total users count\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n  getTotalMentorsCount = async (): Promise<number> => {\r\n    try {\r\n      const count = await this._adminRepository.getTotalMentorsCount();\r\n      return count;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(\"Error in getTotalMentorsCount\", err);\r\n      throw new ServiceError(\r\n        \"Failed to fetch total mentors count\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n  getTotalRevenue = async (): Promise<RevenueStats> => {\r\n    try {\r\n      const revenue = await this._adminRepository.getTotalRevenue();\r\n      return revenue;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(\"Error in getTotalRevenue\", err);\r\n      throw new ServiceError(\r\n        \"Failed to fetch total revenue\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n  getPendingMentorRequestsCount = async (): Promise<number> => {\r\n    try {\r\n      const count = await this._adminRepository.getPendingMentorRequestsCount();\r\n      return count;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(\"Error in getPendingMentorRequestsCount\", err);\r\n      throw new ServiceError(\r\n        \"Failed to fetch pending mentor requests count\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n  getActiveCollaborationsCount = async (): Promise<number> => {\r\n    try {\r\n      const count = await this._adminRepository.getActiveCollaborationsCount();\r\n      return count;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(\"Error in getActiveCollaborationsCount\", err);\r\n      throw new ServiceError(\r\n        \"Failed to fetch active collaborations count\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n  getRevenueTrends = async (\r\n    timeFormat: string,\r\n    days: number\r\n  ): Promise<RevenueTrend[]> => {\r\n    try {\r\n      if (!timeFormat || !days) {\r\n        throw new ServiceError(\r\n          \"Invalid parameters: timeFormat and days are required\",\r\n          StatusCodes.BAD_REQUEST\r\n        );\r\n      }\r\n      const trends = await this._adminRepository.getRevenueTrends(timeFormat, days);\r\n      return trends;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(\"Error in getRevenueTrends\", err);\r\n      throw new ServiceError(\r\n        \"Failed to fetch revenue trends\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n  getUserGrowth = async (\r\n    timeFormat: string,\r\n    days: number\r\n  ): Promise<UserGrowth[]> => {\r\n    try {\r\n      if (!timeFormat || !days) {\r\n        throw new ServiceError(\r\n          \"Invalid parameters: timeFormat and days are required\",\r\n          StatusCodes.BAD_REQUEST\r\n        );\r\n      }\r\n      const growth = await this._adminRepository.getUserGrowth(timeFormat, days);\r\n      return growth;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(\"Error in getUserGrowth\", err);\r\n      throw new ServiceError(\r\n        \"Failed to fetch user growth\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n  getPendingMentorRequests = async (limit?: number): Promise<IMentorDTO[]> => {\r\n    try {\r\n      if (limit && limit < 0) {\r\n        throw new ServiceError(\r\n          \"Invalid limit: must be a non-negative number\",\r\n          StatusCodes.BAD_REQUEST\r\n        );\r\n      }\r\n      const requests = await this._adminRepository.getPendingMentorRequests(limit);\r\n      return toMentorDTOs(requests);\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(\"Error in getPendingMentorRequests\", err);\r\n      throw new ServiceError(\r\n        \"Failed to fetch pending mentor requests\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n  getTopMentors = async (limit: number): Promise<TopMentor[]> => {\r\n    try {\r\n      if (!limit || limit < 0) {\r\n        throw new ServiceError(\r\n          \"Invalid limit: must be a positive number\",\r\n          StatusCodes.BAD_REQUEST\r\n        );\r\n      }\r\n      const mentors = await this._adminRepository.getTopMentors(limit);\r\n      return mentors;\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(\"Error in getTopMentors\", err);\r\n      throw new ServiceError(\r\n        \"Failed to fetch top mentors\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n  getRecentCollaborations = async (\r\n    limit: number\r\n  ): Promise<ICollaborationDTO[]> => {\r\n    try {\r\n      if (!limit || limit < 0) {\r\n        throw new ServiceError(\r\n          \"Invalid limit: must be a positive number\",\r\n          StatusCodes.BAD_REQUEST\r\n        );\r\n      }\r\n      const collaborations = await this._adminRepository.getRecentCollaborations(\r\n        limit\r\n      );\r\n      return toCollaborationDTOs(collaborations);\r\n    } catch (error: unknown) {\r\n      const err = error instanceof Error ? error : new Error(String(error));\r\n      logger.error(\"Error in getRecentCollaborations\", err);\r\n      throw new ServiceError(\r\n        \"Failed to fetch recent collaborations\",\r\n        StatusCodes.INTERNAL_SERVER_ERROR,\r\n        err\r\n      );\r\n    }\r\n  };\r\n\r\n  public AdminprofileDetails = async (userId: string): Promise<IUserAdminDTO | null> => {\r\n      try {\r\n        const user = await this._userRepository.findById(userId);\r\n        logger.info(`Fetched profile details for user ${userId}`);\r\n        return toUserAdminDTO(user);\r\n      } catch (error: unknown) {\r\n        const err = error instanceof Error ? error : new Error(String(error));\r\n        logger.error(\r\n          `Error fetching profile details for user ${userId}: ${err.message}`\r\n        );\r\n        throw error instanceof ServiceError\r\n          ? error\r\n          : new ServiceError(\r\n              \"Failed to fetch profile details\",\r\n              StatusCodes.INTERNAL_SERVER_ERROR,\r\n              err\r\n            );\r\n      }\r\n    };\r\n  \r\n    updateAdminProfile = async (\r\n      userId: string,\r\n      data: ProfileUpdateData\r\n    ): Promise<IUserAdminDTO> => {\r\n      try {\r\n        const user = await this._userRepository.findById(userId);\r\n        if (!user) {\r\n          throw new ServiceError(\"User not found\", StatusCodes.NOT_FOUND);\r\n        }\r\n        let profilePic = user.profilePic ?? undefined;\r\n        if (data.profilePicFile) {\r\n          const { url } = await uploadMedia(\r\n            data.profilePicFile.path,\r\n            \"profiles\",\r\n            data.profilePicFile.size\r\n          );\r\n          profilePic = url;\r\n        }\r\n        const updatedData: Partial<IUser> = {\r\n          name: data.name ?? user.name,\r\n          email: data.email ?? user.email,\r\n          phone: data.phone ?? user.phone,\r\n          dateOfBirth: data.dateOfBirth\r\n            ? new Date(data.dateOfBirth)\r\n            : user.dateOfBirth,\r\n          jobTitle: data.jobTitle ?? user.jobTitle,\r\n          industry: data.industry ?? user.industry,\r\n          reasonForJoining: data.reasonForJoining ?? user.reasonForJoining,\r\n          profilePic,\r\n        };\r\n        const updatedUser = await this._userRepository.update(userId, updatedData);\r\n        if (!updatedUser) {\r\n          throw new ServiceError(\r\n            \"Failed to update user profile\",\r\n            StatusCodes.INTERNAL_SERVER_ERROR\r\n          );\r\n        }\r\n        logger.info(`Updated profile for user ${userId}`);\r\n        return toUserAdminDTO(updatedUser)!;\r\n      } catch (error: unknown) {\r\n        const err = error instanceof Error ? error : new Error(String(error));\r\n        logger.error(`Error updating profile for user ${userId}: ${err.message}`);\r\n        throw error instanceof ServiceError\r\n          ? error\r\n          : new ServiceError(\r\n              \"Failed to update user profile\",\r\n              StatusCodes.INTERNAL_SERVER_ERROR,\r\n              err\r\n            );\r\n      }\r\n    };\r\n}"]}